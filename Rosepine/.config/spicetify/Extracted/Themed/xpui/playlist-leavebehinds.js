"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[5457],{48638:(e,s,l)=>{l.r(s),l.d(s,{default:()=>I});var t=l(59496),a=l(83792),i=l(90065),r=l(14887),n=l(54329),d=l(90022),u=l(21043),c=l(6285),o=l(18737),f=l(30099),h=l(76682),p=l(4637);const v=({leavebehinds:e,surface:s,playlistUri:l,playlistId:t})=>{const a=(0,n.s4)(),i=`${f.ag.get("view.see-all")} (${e.length<=h.fz?f.ag.formatNumber(e.length):f.ag.formatNumber(h.fz)})`;return(0,p.jsx)(u.rU,{to:`/playlist/${t}/see-all-ads`,state:{playlistUri:l},children:(0,p.jsx)(c.o,{"data-testid":"leavebehinds-see-all",buttonSize:"sm",onClick:()=>{a.send((0,o.a)({leavebehind_request_id:e[0].requestId,event:"event_clicked",event_reason:"cta_see_all",surface:s,uri:l}))},children:i})})};var y=l(29199),b=l(93117),m=l(47148);var _=l(82526),g=l(20047);const I=({playlistUri:e,playlistName:s})=>{const l=(0,r.EC)(e)?.id,u=(0,a.v9)(g.N),c=u?.some((e=>e.playlistId===l)),o=(0,b.OO)(b.Tg.PLAYLIST),f=(0,a.I0)(),I=(0,n.s4)(),A=(0,a.v9)((e=>e.ads?.musicLeavebehinds?.playlistId)),N=(0,a.v9)((e=>e.ads.musicLeavebehinds.fetchingState)),U=(0,a.v9)(g.v),k=(0,h.eh)();(0,t.useEffect)((()=>{const t=async()=>{if(l&&!c){f((0,_.ZN)(l));try{const l=await(({uri:e,playlistName:s,url:l})=>m.adsCosmos.post(l,{surface:(0,b.OO)(b.Tg.PLAYLIST),uri:e,playlistTitle:s}))({uri:e,playlistName:s,url:k});f((0,_.Gr)((0,h.D7)({requestId:l.requestId,leavebehindAds:l.leavebehindAds},e)))}catch(e){f((0,_.tD)());const s=e;I.send((0,i.v)({error_type:"fetchAdsFailure",error_message:s.name,http_error_code:s.status,surface:o,request_url:k,request_type:"leavebehindAds"}))}}};A!==l&&t()}),[f,I,c,A,N,l,s,e,o,k]);const q=(0,t.useMemo)((()=>U.slice(0,h.aV)),[U]);return N===y.I.FETCHED&&U.length>0&&l&&e===U[0].playlistUri?(0,p.jsx)(d._,{surface:o,playlistUri:e,leavebehinds:q,seeAllButton:U.length>h.aV?(0,p.jsx)(v,{leavebehinds:U,surface:o,playlistId:l,playlistUri:e}):null}):null}}}]);
//# sourceMappingURL=playlist-leavebehinds.js.map